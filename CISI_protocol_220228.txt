

----make sc-expr data from sce----
TH108_z__largeROIs/...
ROI1_1(I),2_2(E) were used for training
ROI2_3(I),2_4(E) for test

Get cell.csv -> preprocess_sce.Rmd -> training_data_sce.npy / all_genes.npy
Copied them to prj_CISI/__this_d__/training/data/
===========================

----find module dictionary-----
Check (create) folders: result/X_measurements/Y_max/measurement_compositions/

$ python find_modules.py --outpath result --all-genes data/all_genes.npy --select-genes data/selected_genes.txt --datapath data/training_data_sce.npy --dict-size 80 --k-sparsity 3 --lasso-sparsity 0.2 --num-measurements 10 --max-composition 3 --mode G

----make composite phi-----

Manually make csv composite file from /measurement_composition/version_5;
-add header named "channel index' and 'gene'
-each line of csv should be like.. '0','gene1','gene2',,,,
-save at/2_max/


$ python make_phi.py --composites result/10_measurements/2_max/compositions_v5.csv --genes data/selected_genes.txt --savepath result/10_measurements/2_max

----make_prior_abundance----


$ python make_prior_abundance.py --all-genes data/all_genes.npy --selected-genes data/selected_genes.txt --datapath data/training_data_sce.npy --savepath data/

----make correlations between all selected genes----


$ python make_correlations.py --datapath data/data.selected_genes.npy --savepath data/

 not yet working

===========================

Tissue 1,2,3,4,5 = r1_1,r1_2,r2_2,r2_3,r2_4

copy panel.csv to /training/data/
copy/histocat/__tiff_images/ to /individual_image/__renameROIs__
backup in "original" subfolder

----- making composite from individual images -------
/preparation/script/make_compositeimage.py

----- making relabelled(by target name) individual images ------
/preparation/script/rename_individualimage.py

-> all image copy to /output/tissueX/original

===========================

----- cell mask ----
copying as 'mask.tiff'
->/output/tissueX/segmented


---- mask to mask.npz ----
/preprocessing/segmentation_sparse_matrix.py

$ python segmentation_sparse_matrix.py --basepath FilteredCompositeImages --tissues 1,2,3 --mask-file mask.tiff

---- intensity for each cell ----
/preprocessing/segmented_integrated_intensity.py

ran from spyder
Tresholding only works for integrated intensity

===========================

---- Decoding ---
Moved /preparation/, /preprocessing/,/training/ folders under /decompression/segmentation/

/decompression/segmentation/decompress_segmented_cells.py
ran from spyder


